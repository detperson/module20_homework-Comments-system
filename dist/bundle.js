(()=>{"use strict";var e={463:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});class o{showComments(e){let t=document.querySelector(".comment-field"),n="";function o(e){let t=new Date(1e3*e),n=(t.getFullYear(),["01","02","03","04","05","06","07","08","09","10","11","12"][t.getMonth()]),o=t.getDate(),i=t.getHours(),s=t.getMinutes();return t.getSeconds(),o<10&&(o=Number("0"+o.toString())),i<10&&(i=Number("0"+i.toString())),s<10&&(s=Number("0"+s.toString())),o+"."+n+" "+i+":"+s}e.forEach((function(e){" "===e.parent&&(n+=`\n                    <div class="comment" data-comment-id="${e.id}">\n                        <div class="comment__user-logo">\n                            <img class="comment__user-logo-img user-logo-img" src="https://picsum.photos/seed/${e.name}/100" alt="user-logo">\n                        </div>\n                        <div class="comment__form">\n                            <div class="comment__other">\n                                <div class="comment__user-name user-name">\n                                    ${e.name}\n                                </div>\n                                <div class="comment__post-data">\n                                    ${o(e.time)}\n                                </div>\n                            </div>\n                            <div class="comment__text-block">\n                                <p class="comment__body comment__body-for-mobile">\n                                    ${e.body}\n                                </p>\n                            </div>\n                            <div class="comment__footer">\n                                <div class="comment__footer-answer footer-btn">\n                                    <img class="comment__footer-answer-img" src="./images/answer_comment.svg" alt="answer">\n                                    <div class="comment__footer-answer-text">Ответить</div>\n                                </div>\n                                <div class="comment__footer-favorites favorites-btn">\n                                    <div class="comment__footer-favorites-logo"></div>\n                                    <div class="comment__footer-favorites-text">В избранное</div>\n                                </div>\n                                <div class="comment__footer-rating">\n                                    <img class="rating-minus-img" src="./images/minus-rating.svg" alt="minus">\n                                    <div class="rating-count">${e.rating}</div>\n                                    <img class="rating-plus-img" src="./images/plus-rating.svg" alt="plus">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="answers"></div>`)})),null!=t&&(t.innerHTML=n),this.updateCounterComments(),e.forEach((function(e){if(" "!==e.parent){let t="",n=document.querySelectorAll(".comment");n.forEach((function(n){e.parent===n.dataset.commentId&&(t=n.getElementsByClassName("comment__user-name")[0].innerText)}));let i=`\n                    <div class="comment answer" data-comment-id="${e.id}">\n                        <div class="comment__user-logo">\n                            <img class="comment__user-logo-img user-logo-img" src="https://picsum.photos/seed/${e.name}/100" alt="user-logo">\n                        </div>\n                        <div class="comment__form">\n                            <div class="comment__other">\n                                <div class="comment__user-name user-name">\n                                    ${e.name}\n                                </div>\n                                <div class="comment__other__answer-to">\n                                    <div class="comment__other__answer-to-logo">\n                                        <img class="comment__other__answer-to-img" src="./images/answer_comment.svg" alt="answer">\n                                    </div>\n                                    <div class="comment__other__answer-to-text">${t}</div>\n                                </div>\n                                <div class="comment__post-data">\n                                    ${o(e.time)}\n                                </div>\n                            </div>\n                            <div class="comment__text-block">\n                                <p class="comment__body">\n                                    ${e.body}\n                                </p>\n                            </div>\n                            <div class="comment__footer">\n                                <div class="answer__footer-favorites favorites-btn">\n                                    <div class="comment__footer-favorites-logo"></div>\n                                    <div class="comment__footer-favorites-text">В избранное</div>\n                                </div>\n                                <div class="comment__footer-rating">\n                                    <img class="rating-minus-img" src="./images/minus-rating.svg" alt="minus">\n                                    <div class="rating-count">${e.rating}</div>\n                                    <img class="rating-plus-img" src="./images/plus-rating.svg" alt="plus">\n                                </div>\n                            </div>\n                        </div>\n                    </div>`;n.forEach((function(t){var n;e.parent===t.dataset.commentId&&(null===(n=t.nextElementSibling)||void 0===n||n.insertAdjacentHTML("beforeend",i))}))}})),this.ratingColor(),e.forEach((function(e){e.inFavorites&&document.querySelectorAll(".comment__footer-favorites-logo").forEach((function(t){let n=t.closest(".comment").dataset.commentId;e.id==+n&&(t.classList.add("logo-active"),null!=t.nextElementSibling&&(t.nextElementSibling.innerText="В избранном"))}))}))}updateCounterComments(){let e=document.querySelector(".header-panel__comments-counter"),t=JSON.parse(localStorage.getItem("commentss"));null!=e&&(e.innerText=`(${t.length})`)}ratingColor(){let e=document.querySelectorAll(".rating-count");for(let t=0;t<e.length;t++)null!=+e[t]&&(+e[t].textContent>0?e[t].style.color="#8AC540":+e[t].textContent<0?e[t].style.color="#FF0000":0==+e[t].textContent&&(e[t].style.color="rgba(0, 0, 0, .4)"))}changeFavorites(e,t){for(let n=0;n<t.length;n++)t[n].id==+e&&(0==t[n].inFavorites?t[n].inFavorites=!0:t[n].inFavorites=!1)}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=n(463),t=document.querySelector(".input-block__input");t.addEventListener("input",(function(){t.style.height="auto",t.style.height=t.scrollHeight-40+"px",l()}));var o,i=[],s=new e.default;(o=localStorage.getItem("commentss"))&&(i=JSON.parse(o),s.showComments(i));var r=document.querySelector(".btn-send");function a(){localStorage.setItem("commentss",JSON.stringify(i))}function l(){var e=document.querySelector(".input-block__counter-symbol"),n=t.value.length,o=document.querySelector(".input-block__btn-send"),i=document.querySelector(".input-block__warning-long-text");e&&n&&o&&i&&(n<1e3?(e.style.color="green",o.disabled=!1,i.style.opacity="0"):(e.style.color="#FF0000",o.disabled=!0,i.style.opacity="1"),e.innerText="".concat(n,"/1000"))}null==r||r.addEventListener("click",(function(){var e,n=document.getElementById("name-input"),o=document.getElementById("textarea1"),r=null===(e=document.getElementById("parent-answer"))||void 0===e?void 0:e.dataset.parentId,c={id:i.length+1,name:n.value,body:o.value,time:Math.floor(Date.now()/1e3),rating:0,inFavorites:!1,parent:r,answers:0,isChoiceRating:""};l(),""!==n.value&&""!==o.value&&(o.value="",t.style.height="auto",i.push(c)," "!==r&&i.forEach((function(e){e.id==+r&&e.answers++})),a(),s.showComments(i))}));var c=document.querySelector(".header-panel__sort-text");null==c||c.addEventListener("click",(function(){var e=document.getElementById("dropdownSort");e&&e.classList.toggle("show")})),window.onclick=function(e){var t=e.target;if(!(null==t?void 0:t.matches(".header-panel__sort-text"))){var n=document.querySelector(".header-panel__dropdown-content");(null==n?void 0:n.classList.contains("show"))&&n.classList.remove("show")}};var m=document.querySelector(".sort-time");null==m||m.addEventListener("click",(function(){v.classList.contains("increase")&&v.classList.remove("increase"),g(_,f);var e=document.querySelector(".header-panel__sort-text");null!=e&&(e.dataset.sort="time",e.innerText=m.innerText)}));var d=document.querySelector(".sort-rating");null==d||d.addEventListener("click",(function(){v.classList.contains("increase")&&v.classList.remove("increase"),g(p,h);var e=document.querySelector(".header-panel__sort-text");null!=e&&(e.dataset.sort="rating",e.innerText=d.innerText)}));var u=document.querySelector(".sort-answers");null==u||u.addEventListener("click",(function(){v.classList.contains("increase")&&v.classList.remove("increase"),g(y,E);var e=document.querySelector(".header-panel__sort-text");null!=e&&(e.dataset.sort="answers",e.innerText=u.innerText)}));var v=document.querySelector(".header-panel__sort-arrow");function g(e,t){v.classList.contains("increase")?localStorage.getItem("commentss")&&(e(),s.showComments(i)):localStorage.getItem("commentss")&&(t(),s.showComments(i))}function _(){i.sort((function(e,t){return e.time-t.time}))}function f(){i.sort((function(e,t){return t.time-e.time}))}function p(){i.sort((function(e,t){return e.rating-t.rating}))}function h(){i.sort((function(e,t){return t.rating-e.rating}))}function y(){i.sort((function(e,t){return e.answers-t.answers}))}function E(){i.sort((function(e,t){return t.answers-e.answers}))}v.addEventListener("click",(function(){v.classList.toggle("increase");var e=document.querySelector(".header-panel__sort-text");null!=e&&("time"===e.dataset.sort?g(_,f):"rating"===e.dataset.sort?g(p,h):"answers"===e.dataset.sort&&g(y,E))}));var w=document.querySelector(".header-panel__favorites");null==w||w.addEventListener("click",(function(){for(var e=[],t=0;t<i.length;t++)i[t].inFavorites&&e.push(i[t]);s.showComments(e)}));var x=document.querySelector(".comment-field");null==x||x.addEventListener("click",(function(e){var t,n,o,r,l,c,m,d,u,v,g,_,f,p,h,y,E,w,x,b,S,C,L,q,k,I=e.target;if(null!=I){if(I.classList.contains("comment__footer-favorites-text")||I.classList.contains("comment__footer-favorites-logo")){var T=null===(r=null===(o=null===(n=null===(t=I.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.parentElement)||void 0===o?void 0:o.parentElement)||void 0===r?void 0:r.dataset.commentId;s.changeFavorites(T,i),null===(c=null===(l=I.parentElement)||void 0===l?void 0:l.firstElementChild)||void 0===c||c.classList.toggle("logo-active"),(null===(d=null===(m=I.parentElement)||void 0===m?void 0:m.firstElementChild)||void 0===d?void 0:d.classList.contains("logo-active"))?I.parentElement.lastElementChild.innerText="В избранном":(null===(u=I.parentElement)||void 0===u?void 0:u.lastElementChild).innerText="В избранное",a()}if(I.classList.contains("rating-plus-img")){T=null===(f=null===(_=null===(g=null===(v=I.parentElement)||void 0===v?void 0:v.parentElement)||void 0===g?void 0:g.parentElement)||void 0===_?void 0:_.parentElement)||void 0===f?void 0:f.dataset.commentId;for(var $=(N=I.previousElementSibling).textContent="".concat(Number(N.textContent)+1),F=0;F<i.length;F++)i[F].id==+T&&(""===i[F].isChoiceRating?(i[F].rating=+$,i[F].isChoiceRating=!0):!0===i[F].isChoiceRating?N.textContent="".concat(Number(N.textContent)-1):!1===i[F].isChoiceRating&&(i[F].rating=+$,i[F].isChoiceRating=""));a(),s.ratingColor()}else if(I.classList.contains("rating-minus-img")){var N;for(T=null===(E=null===(y=null===(h=null===(p=I.parentElement)||void 0===p?void 0:p.parentElement)||void 0===h?void 0:h.parentElement)||void 0===y?void 0:y.parentElement)||void 0===E?void 0:E.dataset.commentId,$=(N=I.nextElementSibling).textContent="".concat(Number(N.textContent)-1),F=0;F<i.length;F++)i[F].id==+T&&(""===i[F].isChoiceRating?(i[F].rating=+$,i[F].isChoiceRating=!1):!1===i[F].isChoiceRating?N.textContent="".concat(Number(N.textContent)+1):!0===i[F].isChoiceRating&&(i[F].rating=+$,i[F].isChoiceRating=""));a(),s.ratingColor()}if(I.classList.contains("comment__footer-answer-text")||I.classList.contains("comment__footer-answer-img")){var R=(null===(S=null===(b=null===(x=null===(w=I.parentElement)||void 0===w?void 0:w.parentElement)||void 0===x?void 0:x.previousElementSibling)||void 0===b?void 0:b.previousElementSibling)||void 0===S?void 0:S.firstElementChild).innerText,M=document.querySelector(".input-block__parent-answer");null!=M&&(M.style.display="flex",M.innerHTML='\n                <div class="input-block__parent-answer-logo">\n                    <img class="input-block__parent-answer-img" src="./images/answer_comment.svg" alt="answer">\n                </div>\n                <div class="input-block__parent-answer-text">\n                    '.concat(R,"\n                </div>"),T=null===(k=null===(q=null===(L=null===(C=I.parentElement)||void 0===C?void 0:C.parentElement)||void 0===L?void 0:L.parentElement)||void 0===q?void 0:q.parentElement)||void 0===k?void 0:k.dataset.commentId,M.dataset.parentId=T)}}}));var b=document.querySelector(".input-block__parent-answer");null==b||b.addEventListener("click",(function(){null!=b&&(b.style.display="none",b.innerHTML="",b.dataset.parentId=" ")}))})()})();